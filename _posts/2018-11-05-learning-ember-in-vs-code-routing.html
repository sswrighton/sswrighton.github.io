---
layout: post
title: 'Learning Ember in VS Code -- Routing: Optional Dynamic Segments'
date: '2018-11-05T19:00:00.000-06:00'
updated: "2019-03-03 15:46:00"
permalink: "/2018/11/learning-ember-in-vs-code-routing.html" 
author: Stephen Wrighton
tags:
- EmberJs
- JavaScript
modified_time: '2018-11-05T19:00:03.406-06:00'
blogger_id: tag:blogger.com,1999:blog-947968907697915479.post-8972509259568202734
blogger_orig_url: https://programmer.wrighton.org/2018/11/learning-ember-in-vs-code-routing.html
---

<div style="-en-clipboard: true;">Or more accurately, making me cry about routing.&nbsp;</div><div><br /></div><div>I was working on something that I often use as a test development product when trying new tools and design paradigms.&nbsp; Basically, it's a story publishing system similar in nature to <a href="http://fictionpress.com/">FictionPress.com</a>&nbsp;or <a href="http://fanfiction.net/">FanFiction.net</a>.&nbsp; I like this, because it's a fairly complex scenario, but still within the realm of (what I see as) an understandable domain.&nbsp;</div><div><br /></div><div>I like this as a problem space because it has complex structures.&nbsp; At its heart is a STORY, and this story would have attributes (such as title, author, category) and 1 to N CHAPTERS.&nbsp; While each chapter would have attributes (chapter title, content, etc) would have 0 to N COMMENTS.&nbsp;</div><div><br /></div><div>This problem domain gives me nested data elements 3 levels deep, multiple avenues for data filtering and congestion, as well as users at various levels which would impact all of the data elements.&nbsp;</div><div>&nbsp;</div><div>So, I started working on it in Ember, and was doing fairly well until I hit where I was building the route needed to view a specific story, a chapter at a time.</div><div><br /></div><div>What I wanted to do here, was to use dynamic segments to control which story and chapter was displayed to the end user. Specifically, the route would be "/r/:story_id/:chapter_id."&nbsp; Now there are a few things to remember here.&nbsp;&nbsp;</div><div><br /></div><div>The first is that while story_id is the actual identifier for the story to be read, chapter_id is not the chapter identifier, rather it would be the ordinal indicator for that chapter as a sequence within the overarching story.&nbsp; So, a route of /r/123/3 would be the third chapter of story id 123.&nbsp;</div><div><br /></div><div>The second is that chapter_id needed to be optional. If I used the route of "/r/123" then I should have automatically been taken to the first chapter of story 123. Likewise any value outside of a number should also take you to the first chapter, while a numeric value larger than the highest ordinal chapter number should take you to the last chapter.&nbsp; &nbsp;</div><div><br /></div><div>But most of that is a back end issue. It's the optional dynamic segment of :chapter_id that's we needed to focus on. After all, optional dynamic segments are a concept that just doesn't exist in Ember.&nbsp;</div><div><br /></div><div>Worse, is that every example I saw, didn't allow for multiple levels of dynamic segments where the first of them is required and the second of them is dynamic.&nbsp;</div><div><br /></div><div>So, I kicked at it, and created routes and configured them in a dozen different ways until I figured out how I could accomplish this.&nbsp;</div><div><br /></div><div>What I did was built two routes.&nbsp; &nbsp;</div><div><br /></div><div>The first I named "story" and the second I named "story-chapter."&nbsp; &nbsp;Then, instead of nesting the second option inside the first (which is how most of the examples performed something similar to what I was attempting, I entered two lines into the Router.map function found in router.js.&nbsp;</div><div><br /></div><script src="https://gist.github.com/sswrighton/a36464e31e342c8b06dfecbf5609ca00.js"></script><noscript><div>this.route('story', {path: '/r/:story_id'));</div><div>this.route('story-chapter', {path: '/r/:story_id/chapter_id'};</div></noscript><div><br /></div><div>This configuration means that I have to routes for the "/r" root route, one which accepts the story_id dynamic segment, and the second which accepts the story_id and chapter_id dynamic segments.&nbsp;</div><div><br /></div><div>Then in the story.js file, I used this to navigate from the story route to the story-chapter route.&nbsp;</div><div><br /></div><script src="https://gist.github.com/sswrighton/392c0af7bf44d81097dad91537e02127.js"></script><noscript><div>beforeModel: function() {</div><div>&nbsp; &nbsp; var params: this.paramsFor('story');&nbsp;</div><div>&nbsp; &nbsp; this.transitionTo('story-chapter', params.story_id, 1);&nbsp;</div><div>}</div></noscript><div><br /></div><div>Basically, this is the beforeModel function which processes before any data access on the request.&nbsp; Since we know that without a chapter_id dynamic segment, we're supposed to go to the first chapter, this takes the behavior of forcing you to that place.&nbsp;</div><div><br /></div><div>Of course, in story-chapter.js, we can access the various dynamic segments in this fashion:&nbsp;</div><div><br /></div><script src="https://gist.github.com/sswrighton/b28d59339fa7a00ff0fd27b111809510.js"></script><noscript><div>model(params) {</div><div>&nbsp; &nbsp;var storyId = params.story_id;&nbsp;</div><div>&nbsp; &nbsp;var chapterId = params.chapter_id;&nbsp;</div><div>&nbsp; &nbsp;// Get Story/Chapter from store&nbsp;</div><div>};</div></noscript><div><br /></div><div>Now, I just need to get that commented aspect of things working the way I expect.&nbsp;</div><br />