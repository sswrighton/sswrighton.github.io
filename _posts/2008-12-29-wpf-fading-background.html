---
layout: post
title: WPF-Fading Background
date: '2008-12-29T21:50:00.002-06:00'
author: Stephen Wrighton
tags:
- ".NET"
- VB.Net
- Coding
- WPF
modified_time: '2008-12-30T09:03:04.654-06:00'
thumbnail: http://3.bp.blogspot.com/_0dC8-RtLatg/SVo3zpX0W7I/AAAAAAAAAnk/cmA2iiFKzjk/s72-c/animation1.png
blogger_id: tag:blogger.com,1999:blog-947968907697915479.post-1581526715689480907
blogger_orig_url: https://programmer.wrighton.org/2008/12/wpf-fading-background.html
---

Well, the project I'm working on has a few pretties in it; and it has a few tabs that will appear based upon click events on other tabs. Typically, these magically appearing tabs are generated in the primary working area of the application, yet in one scenario, the appearing tab needed to be in the secondary data (for lack of a better term) area of the application.<br /><br />Since, this is effectively non-standard behavior from the application, I wanted to provide a nice visual cue on this happening. I wanted the background to appear one color, and then slowly fade to its standard color.<br /><br />That would be a nice, visual cue about this new window opening. So, I went forth and tried to do it.  My first attempt involved using a brush, and then just changing the opacity until it was transparent. That was utter fail. So, realizing that I wasn't as clever as I had hoped, I turned to my old friend Google.<br /><br />Where I discovered a bit about Storyboards and ColorAnimation objects. Now, I'm not overtly familiar with WPF, and in fact there's quite a bit that I just don't know yet about it; but I was shocked at how easily this worked.<br /><br />What I did was created 2 new SolidColorBrushes, one for the FROM color and one for the TO color. These two colors would be the beginning and ending state for the background of my control. I then shoved these into my ResourceDictionary so that a) I could easily find and manipulate them and b) utilize them elsewhere if needed.<br /><br />Next, I went to the user control I was working with and created on it three new objects, a storyboard, and then two local brush objects.<br /><br />Then in the method I had for loading the control and its data, I created a ColorAnimation object, cloned my two new brushes into my local brush objects, and then shoved them all together.  I activated a timer, and when the timer expired, then I turned on the animation to begin the fade.<br /><br />Lo, and behold, it worked! And it worked well.  It's pretty, it works great as an indicator, all-in-all I was quite pleased with myself.<br /><br />Anyways, the following two screencaps show the relevant code in question.<br /><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://3.bp.blogspot.com/_0dC8-RtLatg/SVo3zpX0W7I/AAAAAAAAAnk/cmA2iiFKzjk/s1600-h/animation1.png"><img style="margin: 0px auto 10px; display: block; text-align: center; cursor: pointer; width: 320px; height: 98px;" src="http://3.bp.blogspot.com/_0dC8-RtLatg/SVo3zpX0W7I/AAAAAAAAAnk/cmA2iiFKzjk/s320/animation1.png" alt="" id="BLOGGER_PHOTO_ID_5285598473091308466" border="0" /></a><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://4.bp.blogspot.com/_0dC8-RtLatg/SVo3zqm1UsI/AAAAAAAAAns/Ztl1VFEvv0A/s1600-h/animation2.png"><img style="margin: 0px auto 10px; display: block; text-align: center; cursor: pointer; width: 320px; height: 74px;" src="http://4.bp.blogspot.com/_0dC8-RtLatg/SVo3zqm1UsI/AAAAAAAAAns/Ztl1VFEvv0A/s320/animation2.png" alt="" id="BLOGGER_PHOTO_ID_5285598473422721730" border="0" /></a><br />Enjoy.