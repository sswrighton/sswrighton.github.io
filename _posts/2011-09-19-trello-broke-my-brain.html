---
layout: post
title: Trello Broke My Brain...
date: '2011-09-19T19:01:00.000-05:00'
updated: "2019-03-07 19:46:00"
permalink: "/2011/09/trello-broke-my-brain.html"
author: Stephen Wrighton
tags:
- JavaScript
- ".NET"
- Visual Studio
- programming
- VB.Net
- ASP.Net
- Coding
- Web
modified_time: '2011-09-19T19:01:00.180-05:00'
thumbnail: http://4.bp.blogspot.com/-Xp0BAER4IEw/TneJgCKTtLI/AAAAAAAABEA/mobcMpbT40U/s72-c/trello.png
blogger_id: tag:blogger.com,1999:blog-947968907697915479.post-5285158079039741360
blogger_orig_url: https://programmer.wrighton.org/2011/09/trello-broke-my-brain.html
---

Here's a secret, whenever I stumble across a web application that I think is awesome, I look at its source-code in an attempt to figure out how they're doing it. Quite often, one can find quite a bit of information by looking at various JavaScript elements, not to mention how the various HTML elements are named.<br /><br /><table cellpadding="0" cellspacing="0" class="tr-caption-container" style="float: right; margin-left: 1em; text-align: right;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-Xp0BAER4IEw/TneJgCKTtLI/AAAAAAAABEA/mobcMpbT40U/s1600/trello.png" imageanchor="1" style="clear: right; margin-bottom: 1em; margin-left: auto; margin-right: auto;"><img border="0" height="142" src="http://4.bp.blogspot.com/-Xp0BAER4IEw/TneJgCKTtLI/AAAAAAAABEA/mobcMpbT40U/s320/trello.png" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Trello!</td></tr></tbody></table>So, of course, when I discovered <a href="http://www.trello.com/">Trello</a>, I had to take a gander. And I must say that I do love Trello. It's the first task organizer that I've actually wanted to use, and as one can see, I'm hoping to generate a nice set of tasks for <a href="http://ecomic.codeplex.com/">eComic</a> so I can actually keep track of my development efforts there. <br /><br />At which time, I discovered that Trello doesn't appear to have any of the typical hallmarks by which I would get insights into how things are built.<br /><br />Case in point, there wasn't really any elements on the page which contained little things like NAMES or IDs.<br /><br />But, it did provide me the name of a few of the JS libraries that it used. I found the typical JQuery and JQuery UI libraries, and even the somewhat ubiquitous (at least for Frog Creek software products) JSON2 and MARKDOWN libraries. <br /><br />But there were a few that I had never heard of at all:<br /><ul><li>backbone.js</li><li>highcharts.js</li><li>socket.io.js</li><li>underscore.js</li></ul><br />Which is a list which sent me stumbling through the depths of... some developer-appropriate underworld.<br /><br /><a href="http://www.highcharts.com/">Highcharts.js</a> was an interesting find, as it's interactive charting object for web projects. But, there's nothing that well, mind-blowing hiding in its background.<br /><br />That's where those other 3 classes come into play.&nbsp; <a href="http://documentcloud.github.com/underscore/">Underscore</a> &amp; <a href="http://documentcloud.github.com/backbone/">Backbone</a> work hand-in-hand to provide Model-View-ViewModel and Templating into web projects, while <a href="http://socket.io/">Socket.Io.js</a>' whole purpose is for the development of real-time apps.<br /><br />I read through these elements, and considered how they were integrated in LAMP environments, and then began pondering how I could integrate them into an ASP.Net/IIS world.<br /><br />What I had, was that I wanted to implement the Model-View-ViewModel scenario, coupled with Real-time collaboration without having the browser POLL for the data changes. Which, let's be honest, is not exactly the most easy thing to do in ASP.Net. <br /><br />The first thing I went after was the Model-View-ViewModel situation. While reading up on these elements, I discovered the <a href="http://knockoutjs.com/">KnockOut</a> library.&nbsp; This looked quite happy, and it was using the JQuery Templating engine, which I had previous experience with. Thus, I ran through its tutorials, and got my code generating templated HTML based upon a view model that had its data loaded by a secondary call to a web service which returns a JSON object.<br /><br />Well, that had me dancing for a few days, especially after I got things like sorting working the way I would expect for it to on the application.<br /><br />Which is when I jumped off the deep end.&nbsp;<br /><br />The other half of my task was to generate a real-time colloboration system, which basically entails the SQL SERVER having to notify the associated web-pages about changes to the specific set of data that is being displayed on a given web page.<br /><br />The theory is that if I had two people looking at BOARD A, and three people at BOARD B, whenever BOARD A's data was modified, I wanted those who were looking at BOARD A to be notified (via the data being changed), but NOT those that were looking at BOARD B.<br /><br />And I was doing this in IIS and .NET without the benefits of NODE.js and Sockets.Io.&nbsp; In a few years, when websockets become more common (sadly, IE9 doesn't even have these things) then the way I did this might change. After all, HTML5 websockets are designed to provide this concept. Sadly, we're not there yet.<br /><br />But, what we do have ARE <a href="http://msdn.microsoft.com/en-us/library/ms227433%28v=vs.85%29.aspx">Asynchronous HTTP Handlers</a>, and the <a href="http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldependency.aspx">SqlDependency</a> class.<br /><br />Basically, what's happening, is that I have an asynchronous web service which I call when I load the page. This web service spawns off a new thread which registers a SqlDependency on the relevant query for a board (and based on last UPDATE time).&nbsp; When the result set for that relevant query changes (i.e. values are MODIFIED!)&nbsp; then it raises an event, which completes the asynchronous call to the handler.<br /><br />This provides me the ability to have my SQL Server send out notifications to my HTML pages (which are stateless remember!) that its data has changed.&nbsp; Thus, I have the secret to near-real-time collaboration!<br /><br />