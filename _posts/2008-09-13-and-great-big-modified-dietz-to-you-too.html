---
layout: post
title: And A Great Big Modified Dietz To You Too
date: '2008-09-13T01:25:00.000-05:00'
updated: "2019-03-07 19:46:00"
permalink: "/2008/09/and-great-big-modified-dietz-to-you-too.html"
author: Stephen Wrighton
tags:
- ".NET"
- programming
- Coding
modified_time: '2008-09-13T01:25:00.325-05:00'
thumbnail: http://3.bp.blogspot.com/_0dC8-RtLatg/SMq2zkaoMlI/AAAAAAAAAYw/OKY2o_GXlMI/s72-c/ReturnMDietz.gif
blogger_id: tag:blogger.com,1999:blog-947968907697915479.post-560828692220418670
blogger_orig_url: https://programmer.wrighton.org/2008/09/and-great-big-modified-dietz-to-you-too.html
---

I don't work well in the heat. Especially when it's a heat without airflow. Sure, the office was only 82 degrees F, but without a fan or anything, I was just flat-out miserable and all I wanted to do was curl up somewhere and gaze at a wall or something.  Heck, I seriously considered going out to the truck, and getting my gym bag to trade my work clothes for my work-out clothes, all in an effort to keep my brain from overheating.<br /><br />Or in Bender parlance, I was just shy of closing my eyes, and when I re-opened them stating "Insert Girder."<br /><br />Now, why is this important? And more importantly, why am I bringing my issues with heat up on my programming blog? Well, outside of the fact that the heat thing happened at work, this heat thing slapped me down while I was trying to uncover the secrets of using four different algorithms.<br /><br />Sure, they all calculate the same types of data, but they do it in highly divergent ways.<br /><br />What algorithms you ask?  Well, they're financial ones, specifically those related to calculating Investment Performance. The four in question are: Internal Rate of Return, Daily Valuation, Modified Dietz and Modified BAI (sometimes called Modified IRR).<br /><br />Now, these things are evil. They're geometric algorithms, as they deal with compounding data sets over time, with sums and subtractions in addition to, and conjunction with the compounding data.<br /><br />Don't believe me?  Then look at this:<br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://3.bp.blogspot.com/_0dC8-RtLatg/SMq2zkaoMlI/AAAAAAAAAYw/OKY2o_GXlMI/s1600-h/ReturnMDietz.gif"><img style="margin: 0px auto 10px; display: block; text-align: center; cursor: pointer;" src="http://3.bp.blogspot.com/_0dC8-RtLatg/SMq2zkaoMlI/AAAAAAAAAYw/OKY2o_GXlMI/s200/ReturnMDietz.gif" alt="" id="BLOGGER_PHOTO_ID_5245205713091310162" border="0" /></a>Or how about this:<br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://1.bp.blogspot.com/_0dC8-RtLatg/SMq2zh6mP_I/AAAAAAAAAYo/Q1VUZad9V4M/s1600-h/ReturnIRR_black.gif"><img style="margin: 0px auto 10px; display: block; text-align: center; cursor: pointer;" src="http://1.bp.blogspot.com/_0dC8-RtLatg/SMq2zh6mP_I/AAAAAAAAAYo/Q1VUZad9V4M/s200/ReturnIRR_black.gif" alt="" id="BLOGGER_PHOTO_ID_5245205712420093938" border="0" /></a><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://4.bp.blogspot.com/_0dC8-RtLatg/SMq6n7g8AKI/AAAAAAAAAY4/LDwphx5vXPQ/s1600-h/eggfriedonsidewalk.jpg"><img style="margin: 0pt 0pt 10px 10px; float: right; cursor: pointer;" src="http://4.bp.blogspot.com/_0dC8-RtLatg/SMq6n7g8AKI/AAAAAAAAAY4/LDwphx5vXPQ/s200/eggfriedonsidewalk.jpg" alt="" id="BLOGGER_PHOTO_ID_5245209911179870370" border="0" /></a>Yes, those are two of the formulas I'm turning into a calculator. And doing it while my brain is frying like one of those proverbial eggs.<br /><br />Hmm, now if only I had some bacon.<br /><br />Alas, thanks to our good friends at Wikipedia, at least some of the Modified Dietz things have been dealt with. <a href="http://en.wikipedia.org/wiki/Modified_Dietz_Method">Their article</a> provides this VB source code for calculating Modified Dietz:<pre><blockquote>    <span style="color: rgb(0, 153, 0);">'Jelle-Jeroen Lamkamp 10 Jan 2008</span><br />   Dim i As Integer: Dim Cash() As Double: Dim Days() As Integer<br />   Dim Cell As Range: Dim SumCash As Double: Dim TempSum As Double<br />  <br />   <span style="color: rgb(0, 153, 0);">'Some error trapping</span><br />   If rCash.Cells.Count <> rDays.Cells.Count Then MDIETZ = CVErr(xlErrValue): Exit Function<br />   If Application.WorksheetFunction.Max(rDays) > iPeriod Then MDIETZ = CVErr(xlErrValue): Exit Function<br />  <br />   ReDim Cash(rCash.Cells.Count - 1)<br />   ReDim Days(rDays.Cells.Count - 1)<br />  <br />   i = 0<br />   For Each Cell In rCash<br />       Cash(i) = Cell.Value: i = i + 1<br />   Next Cell<br />  <br />   i = 0<br />   For Each Cell In rDays<br />       Days(i) = Cell.Value: i = i + 1<br />   Next Cell<br />  <br />   SumCash = Application.WorksheetFunction.Sum(rCash)<br /><br />   TempSum = 0<br />   For i = 0 To (rCash.Cells.Count - 1)<br />           TempSum = TempSum + (((iPeriod - Days(i)) / iPeriod) * Cash(i))<br />   Next i<br />    MDIETZ = (dEndValue - dStartValue - SumCash) / (dStartValue + TempSum)<br /></blockquote>Thanks Wiki!!<br />  <br /><br /></pre>