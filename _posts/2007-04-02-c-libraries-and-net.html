---
layout: post
title: C Libraries and .NET
date: '2007-04-02T16:30:00.000-05:00'
author: Stephen Wrighton
tags: 
modified_time: '2007-04-02T16:39:54.135-05:00'
blogger_id: tag:blogger.com,1999:blog-947968907697915479.post-457624959010950363
blogger_orig_url: https://programmer.wrighton.org/2007/04/c-libraries-and-net.html
---

This is still insane. I spoke early last week about .NET and my C Library problem - which is the root cause of me not having any spare time to blog about programming and have discovered a bit more.<br /><br />If I run the library directly through a C++.Net Console application it works without a problem. But if I try to use the DLL version even in the Console application it gives me the <span style="font-weight: bold;">NULL REFERENCE</span> exception.<br /><br />The only thing that makes sense to explain this issue is that since the DLL version uses a class as a container for the various methods where I pass data to/from the library in a "managed" way this is setting aside a certain bundle of memory for the library. Which the library tries to get outside of by doing a <span style="font-weight: bold;">MALLOC </span>call, and thus resulting in the <span style="font-weight: bold;">NULL REFERENCE</span> exception.<br /><br />So I'm faced with three possibilities (excluding retiring the project, which is a decision I can't make):<br /><ol><li>Rewrite the libraries in a .NET language</li><li>Write a C++.Net console application and call that from the VB.Net GUI when I need to do something - passing data through the command line and file I/O<br /></li><li>Write a Windows Service in C++.Net and pass data to/from the service via the Message Queues</li></ol>Option 1 was shot down in an earlier meeting - but it's always there. So that leaves us with options 2 and 3.<br /><br />Now, I can admit it's been years since I've done any serious C++ programming. Not since I graduated college - it's an atrophied skill as my job is a VB shop.  The closest I've come is a bit of C# programming when the task I need/want to do is easier to implement there than in VB.<br /><br />So with that in mind, I came up with this table to determine which of the last two options I should consider.<br /><br /> <table class="MsoTableGrid" style="border: medium none ; border-collapse: collapse;" border="1" cellpadding="0" cellspacing="0">  <tbody><tr style="">   <td colspan="2" style="border: 1pt solid windowtext; padding: 0in 5.4pt; background: rgb(243, 243, 243) none repeat scroll 0%; width: 214.3pt; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;" valign="top" width="286">   <p class="MsoNormal" style="text-align: center;" align="center"><b style=""><span style="font-size: 12pt;"><span style="font-size:100%;">Service</span><o:p></o:p></span></b></p>   </td>   <td colspan="3" style="border-style: solid solid solid none; border-color: windowtext windowtext windowtext -moz-use-text-color; border-width: 1pt 1pt 1pt medium; padding: 0in 5.4pt; background: rgb(243, 243, 243) none repeat scroll 0%; width: 228.5pt; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;" valign="top" width="305">   <p class="MsoNormal" style="text-align: center;" align="center"><b style=""><span style="font-size: 12pt;"><span style="font-size:100%;">Console</span><o:p></o:p></span></b></p>   </td>  </tr>  <tr style="">   <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0in 5.4pt; width: 45.9pt;" valign="top" width="61">   <p class="MsoNormal"><b style="">About<o:p></o:p></b></p>   </td>   <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0in 5.4pt; width: 168.4pt;" valign="top" width="225">   <p class="MsoNormal">Use a Windows Service and Message Queues to send/receive   data<o:p></o:p></p>   </td>   <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0in 5.4pt; width: 47.6pt;" valign="top" width="63">   <p class="MsoNormal"><b style="">About<o:p></o:p></b></p>   </td>   <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0in 5.4pt; width: 2.5in;" valign="top" width="240">   <p class="MsoNormal">Use either a series of task-specific console applications   or a single console application with task flags. Use VB.Net to launch those   applications and feed in parameters on the command line. Output saved to a   file which the VB.Net application then reads in.<o:p></o:p></p>   </td>   <td style="border: medium none ; padding: 0in;" width="1"><p class="MsoNormal"> </p></td>  </tr>  <tr style="">   <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0in 5.4pt; width: 45.9pt;" valign="top" width="61">   <p class="MsoNormal"><b style="">Pros<o:p></o:p></b></p>   </td>   <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0in 5.4pt; width: 168.4pt;" valign="top" width="225">   <p class="MsoNormal" style="margin-left: 17.1pt; text-indent: -17.1pt;"><!--[if !supportLists]--><span style="font-family: Symbol;"><span style="">·<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">           </span></span></span><!--[endif]-->Simpler to maintain than a series of task   specific applications<o:p></o:p></p>   <p class="MsoNormal" style="margin-left: 17.1pt; text-indent: -17.1pt;"><!--[if !supportLists]--><span style="font-family: Symbol;"><span style="">·<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">           </span></span></span><!--[endif]-->Can pass well-defined data easily through the   message queues<o:p></o:p></p>   <p class="MsoNormal" style="margin-left: 17.1pt; text-indent: -17.1pt;"><!--[if !supportLists]--><span style="font-family: Symbol;"><span style="">·<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">           </span></span></span><!--[endif]-->No File I/O<o:p></o:p></p>   </td>   <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0in 5.4pt; width: 47.6pt;" valign="top" width="63">   <p class="MsoNormal"><b style="">Pros<o:p></o:p></b></p>   </td>   <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0in 5.4pt; width: 2.5in;" valign="top" width="240">   <p class="MsoNormal" style="margin-left: 17.1pt; text-indent: -17.1pt;"><!--[if !supportLists]--><span style="font-family: Symbol;"><span style="">·<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">           </span></span></span><!--[endif]-->Easier to develop<o:p></o:p></p>   <p class="MsoNormal"><o:p> </o:p></p>   </td>   <td style="border: medium none ; padding: 0in;" width="1"><p class="MsoNormal"> </p></td>  </tr>  <tr style="">   <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0in 5.4pt; width: 45.9pt;" valign="top" width="61">   <p class="MsoNormal"><b style="">Cons<o:p></o:p></b></p>   </td>   <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0in 5.4pt; width: 168.4pt;" valign="top" width="225">   <p class="MsoNormal" style="margin-left: 17.1pt; text-indent: -17.1pt;"><!--[if !supportLists]--><span style="font-family: Symbol;"><span style="">·<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">           </span></span></span><!--[endif]-->Harder to code<o:p></o:p></p>   <p class="MsoNormal" style="margin-left: 17.1pt; text-indent: -17.1pt;"><!--[if !supportLists]--><span style="font-family: Symbol;"><span style="">·<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">           </span></span></span><!--[endif]-->More complex system<o:p></o:p></p>   <p class="MsoNormal"><o:p> </o:p></p>   </td>   <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0in 5.4pt; width: 47.6pt;" valign="top" width="63">   <p class="MsoNormal"><b style="">Cons<o:p></o:p></b></p>   </td>   <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0in 5.4pt; width: 2.5in;" valign="top" width="240">   <p class="MsoNormal" style="margin-left: 17.1pt; text-indent: -17.1pt;"><!--[if !supportLists]--><span style="font-family: Symbol;"><span style="">·<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">           </span></span></span><!--[endif]-->Memory Intensive from launching all the small   applications<o:p></o:p></p>   <p class="MsoNormal" style="margin-left: 17.1pt; text-indent: -17.1pt;"><!--[if !supportLists]--><span style="font-family: Symbol;"><span style="">·<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">           </span></span></span><!--[endif]-->Slow due to File I/O<o:p></o:p></p>   <p class="MsoNormal"><o:p> </o:p></p>   </td>   <td style="border: medium none ; padding: 0in;" width="1"><p class="MsoNormal"> </p></td>  </tr>  <tr style="">   <td style="border-style: none solid solid; border-color: -moz-use-text-color windowtext windowtext; border-width: medium 1pt 1pt; padding: 0in 5.4pt; width: 45.9pt;" valign="top" width="61">   <p class="MsoNormal"><b style="">Need to Learn<o:p></o:p></b></p>   </td>   <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0in 5.4pt; width: 168.4pt;" valign="top" width="225">   <p class="MsoNormal" style="margin-left: 17.1pt; text-indent: -17.1pt;"><!--[if !supportLists]--><span style="font-family: Symbol;"><span style="">·<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">           </span></span></span><!--[endif]-->Coding windows service in C++.Net<o:p></o:p></p>   <p class="MsoNormal" style="margin-left: 17.1pt; text-indent: -17.1pt;"><!--[if !supportLists]--><span style="font-family: Symbol;"><span style="">·<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">           </span></span></span><!--[endif]-->Using Message Queues in C++.Net<o:p></o:p></p>   </td>   <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0in 5.4pt; width: 47.6pt;" valign="top" width="63">   <p class="MsoNormal"><b style="">Need to Learn<o:p></o:p></b></p>   </td>   <td style="border-style: none solid solid none; border-color: -moz-use-text-color windowtext windowtext -moz-use-text-color; border-width: medium 1pt 1pt medium; padding: 0in 5.4pt; width: 2.5in;" valign="top" width="240">   <p class="MsoNormal" style="margin-left: 17.1pt; text-indent: -17.1pt;"><!--[if !supportLists]--><span style="font-family: Symbol;"><span style="">·<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">           </span></span></span><!--[endif]-->How to launch other applications within VB.Net   via its internal scripting system<o:p></o:p></p>   <p class="MsoNormal" style="margin-left: 17.1pt; text-indent: -17.1pt;"><!--[if !supportLists]--><span style="font-family: Symbol;"><span style="">·<span style="font-family: &quot;Times New Roman&quot;; font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;">           </span></span></span><!--[endif]-->Refresh how to pass arguments into a console   application via the command line when the system begins executing<o:p></o:p></p>   </td>   <td style="border: medium none ; padding: 0in;" width="1"><p class="MsoNormal"> </p></td>  </tr> </tbody></table>